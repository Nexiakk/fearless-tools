<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fearless Tools</title>
    <link rel="icon" type="image/x-icon" href="/assets/images/cwel.png" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="stylesheet" href="css/champion-pool.css" />
    <link rel="stylesheet" href="css/drafting-tool.css" />
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@alpinejs/morph@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@headlessui/alpine@2.1/dist/headlessui.min.js"></script>
    <script src="js/data/champions.js"></script>
    <script src="js/firebase/firebase-init.js"></script>
    <script src="js/components/draftHelper.js"></script>
  </head>
  <body x-data="draftHelper()" x-init="init()" @destroy="destroy()">
    <svg width="0" height="0" style="position: absolute">
      <defs>
        <symbol id="icon-plus" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm.75-11.25a.75.75 0 0 0-1.5 0v2.5h-2.5a.75.75 0 0 0 0 1.5h2.5v2.5a.75.75 0 0 0 1.5 0v-2.5h2.5a.75.75 0 0 0 0-1.5h-2.5v-2.5Z" clip-rule="evenodd" /></symbol>
        <symbol id="icon-close" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16ZM8.28 7.22a.75.75 0 0 0-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 1 0 1.06 1.06L10 11.06l1.72 1.72a.75.75 0 1 0 1.06-1.06L11.06 10l1.72-1.72a.75.75 0 0 0-1.06-1.06L10 8.94 8.28 7.22Z" clip-rule="evenodd" /></symbol>
        <symbol id="icon-save" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 2a8 8 0 1 0 0 16 8 8 0 0 0 0-16ZM8.5 3.75a.75.75 0 0 0-1.5 0v4.5a.75.75 0 0 0 1.5 0v-4.5Zm3 1.5a.75.75 0 0 0-1.5 0v7.5a.75.75 0 0 0 1.5 0v-7.5Z" clip-rule="evenodd" /></symbol>
        <symbol id="icon-note" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M5.75 3A2.75 2.75 0 0 0 3 5.75v8.5A2.75 2.75 0 0 0 5.75 17h8.5A2.75 2.75 0 0 0 17 14.25v-8.5A2.75 2.75 0 0 0 14.25 3H5.75ZM5 5.75c0-.414.336-.75.75-.75h8.5c.414 0 .75.336.75.75v8.5c0 .414-.336.75-.75.75h-8.5c-.414 0-.75-.336-.75-.75V5.75Zm3.25 2a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5h-3.5Z" clip-rule="evenodd" /></symbol>
        <symbol id="icon-load" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M4.5 2A1.5 1.5 0 0 0 3 3.5v13A1.5 1.5 0 0 0 4.5 18h11a1.5 1.5 0 0 0 1.5-1.5V7.621a1.5 1.5 0 0 0-.44-1.06l-4.12-4.122A1.5 1.5 0 0 0 11.378 2H4.5Zm7.5 1.5V7h3.5L12 3.5ZM5 7.75A.75.75 0 0 1 5.75 7h3.5a.75.75 0 0 1 0 1.5h-3.5A.75.75 0 0 1 5 7.75Zm0 3A.75.75 0 0 1 5.75 10h8.5a.75.75 0 0 1 0 1.5h-8.5A.75.75 0 0 1 5 10.75Zm0 3A.75.75 0 0 1 5.75 13h8.5a.75.75 0 0 1 0 1.5h-8.5A.75.75 0 0 1 5 13.75Z" clip-rule="evenodd" />
        </symbol>
        <symbol id="icon-trash" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M8.75 1A2.75 2.75 0 0 0 6 3.75V4.5h8V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.5.66 1.5 1.5v.75h-3v-.75C8.5 4.66 9.16 4 10 4ZM4.118 6A1 1 0 0 0 3.13 6.886l.434 9.548A2 2 0 0 0 5.558 18h8.884a2 2 0 0 0 1.994-1.566l.434-9.548A1 1 0 0 0 15.882 6H4.118ZM8.75 9.75a.75.75 0 0 1 .75-.75h1a.75.75 0 0 1 0 1.5h-1a.75.75 0 0 1-.75-.75Zm3 0a.75.75 0 0 1 .75-.75h1a.75.75 0 0 1 0 1.5h-1a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" />
        </symbol>
        <symbol id="icon-edit" viewBox="0 0 20 20"><path d="M13.586 3.586a2 2 0 1 1 2.828 2.828l-.793.793-2.828-2.828.793-.793ZM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828Z" /></symbol>
        <symbol id="icon-search" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M9 3.5a5.5 5.5 0 1 0 0 11 5.5 5.5 0 0 0 0-11ZM2 9a7 7 0 1 1 12.452 4.391l3.328 3.329a.75.75 0 1 1-1.06 1.06l-3.329-3.328A7 7 0 0 1 2 9Z" clip-rule="evenodd" /></symbol>
        <symbol id="icon-check" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 0 1 .143 1.052l-8 10.5a.75.75 0 0 1-1.127.075l-4.5-4.5a.75.75 0 0 1 1.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 0 1 1.05-.143Z" clip-rule="evenodd" /></symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24">
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
          />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </symbol>
      </defs>
    </svg>

    <header class="top-navbar">
      <div class="navbar-container">
        <div x-show="currentView === 'pool'" class="view-switcher-navbar-container">
          <div class="view-switcher-navbar">
            <button @click="championPoolView = 'grid'" class="view-switch-button-navbar" :class="{'active': championPoolView === 'grid'}">Grid</button>
            <button @click="championPoolView = 'compact'" class="view-switch-button-navbar" :class="{'active': championPoolView === 'compact'}">Compact</button>
          </div>
        </div>
        <nav class="navbar-nav">
          <button @click="currentView = 'pool'" :class="{'nav-link': true, 'active': currentView === 'pool'}">Champion Pool</button>
          <button @click="currentView = 'drafting'" :class="{'nav-link': true, 'active': currentView === 'drafting'}">Drafting</button>
        </nav>
        <div class="absolute right-4">
          <button @click="isSettingsOpen = true" class="text-gray-400 hover:text-white transition-colors" title="Settings">
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <use href="#icon-settings"></use>
            </svg>
          </button>
        </div>
      </div>
    </header>

    <div class="container-fluid mx-auto p-4 main-content">
      <div class="relative">
        <div x-show="currentView === 'pool'" class="absolute w-full top-0 left-0">
          <div class="controls-container">
            <div class="controls-row-bottom">
              <div class="relative search-container" x-show="championPoolView === 'grid'">
                <svg class="search-icon"><use href="#icon-search"></use></svg>
                <input type="text" x-model="searchTerm" placeholder="Search..." class="pool-search-input" /> <button x-show="searchTerm" @click="searchTerm = ''" class="clear-search-button" aria-label="Clear search">&times;</button>
              </div>
              <div class="role-filters-container" x-show="championPoolView === 'grid'">
                <button @click="setFilter('Top', 'role')" class="filter-button icon-button" :class="{'active': roleFilter === 'Top'}" title="Filter by Top Lane">
                  <img :src="getRoleIconUrl('Top')" alt="Top Lane" class="filter-icon" draggable="false" />
                </button>
                <button @click="setFilter('Jungle', 'role')" class="filter-button icon-button" :class="{'active': roleFilter === 'Jungle'}" title="Filter by Jungle">
                  <img :src="getRoleIconUrl('Jungle')" alt="Jungle" class="filter-icon" draggable="false" />
                </button>
                <button @click="setFilter('Mid', 'role')" class="filter-button icon-button" :class="{'active': roleFilter === 'Mid'}" title="Filter by Mid Lane">
                  <img :src="getRoleIconUrl('Mid')" alt="Mid Lane" class="filter-icon" draggable="false" />
                </button>
                <button @click="setFilter('Bot', 'role')" class="filter-button icon-button" :class="{'active': roleFilter === 'Bot'}" title="Filter by Bot Lane">
                  <img :src="getRoleIconUrl('Bot')" alt="Bot Lane" class="filter-icon" draggable="false" />
                </button>
                <button @click="setFilter('Support', 'role')" class="filter-button icon-button" :class="{'active': roleFilter === 'Support'}" title="Filter by Support">
                  <img :src="getRoleIconUrl('Support')" alt="Support" class="filter-icon" draggable="false" />
                </button>
              </div>
              <div class="sort-reset-container">
                <div x-show="settings.pool.showPlayerTier && championPoolView === 'grid'" class="flex items-center gap-2">
                  <span class="sort-label">Sort By:</span>
                  <button @click="setSortOrder('name')" class="sort-button" :class="{'active': sortOrder === 'name'}">Name</button>
                  <button @click="setSortOrder('tier')" class="sort-button" :class="{'active': sortOrder === 'tier'}">Tier</button>
                </div>
                <div>
                  <button @click="openConfirmationModal({ message: 'Are you sure you want to reset highlighted picks?', confirmAction: () => resetMarkedPicksAction() })" class="reset-button reset-marked bg-blue-700 hover:bg-blue-600 text-white ml-2" aria-label="Reset highlighted picks">Reset Highlighted</button>
                  <button @click="openConfirmationModal({ message: 'Reset unavailable champions? This cannot be undone.', confirmAction: () => resetDraftSeriesAction(), isDanger: true })" class="reset-button reset-series bg-yellow-700 hover:bg-yellow-600 text-white ml-2" aria-label="Reset unavailable champions">Reset Unavailable</button>
                </div>
              </div>
            </div>
          </div>

          <div class="pool-main-area">
            <div x-show="championPoolView === 'grid'" class="pool-view-wrapper" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
              <div class="champion-grid-with-filter-container">
                <div class="alphabet-filter-container">
                  <button @click="setAlphabetFilter('all')" class="font-bold" :class="{'active': alphabetFilter === 'all'}">All</button>
                  <template x-for="letter in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('')" :key="letter">
                    <button @click="setAlphabetFilter(letter)" :class="{'active': alphabetFilter === letter}" x-text="letter"></button>
                  </template>
                </div>

                <div class="champion-grid-container">
                  <div class="champion-grid-inner" x-data="{}" x-init="$el.setAttribute('x-morph', 'once')" x-morph:morph>
                    <p x-show="filteredChampions.length === 0" class="text-gray-400 col-span-full text-center py-4" x-cloak>No champions match your filter/search.</p>
                    <template x-for="champion in filteredChampions" :key="champion.id">
                      <div
                        class="champion-card"
                        :class="{
                            'unavailable': isUnavailable(champion.name),
                            'manually-marked': isHighlighted(champion.name),
                            'in-pool': champion.poolInfo && champion.poolInfo.isInPool,
                            'not-in-pool': (!champion.poolInfo || !champion.poolInfo.isInPool) && !isUnavailable(champion.name) && !isHighlighted(champion.name),
                            [champion.poolInfo?.tierClass || 'tier-DEFAULT']: champion.poolInfo && champion.poolInfo.isInPool && !isUnavailable(champion.name),
                            'no-borders': !settings.pool.showPlayerTier,
                            'hide-player-tier-info': !settings.pool.showPlayerTier,
                            'hide-role-badges': !settings.pool.showRoleBadges,
                            'dimmed': alphabetFilter !== 'all' && !champion.name.toUpperCase().startsWith(alphabetFilter)
                         }"
                        @click="togglePick(champion.name)"
                        @contextmenu.prevent="toggleHighlight(champion.name)"
                        role="button"
                        :aria-label="champion.name"
                        :tabindex="0"
                        x-cloak
                        :title="champion.name"
                      >
                        <div class="champion-icon-wrapper">
                          <img class="champion-icon" :src="getChampionIconUrl(champion.name)" :alt="champion.name" loading="lazy" draggable="false" />
                          <div class="champion-icon-corners"></div>
                        </div>
                        <span class="champion-name-text text-gray-200" x-text="champion.name"></span>
                        <span class="badge tier-badge" x-show="champion.poolInfo?.isInPool && champion.poolInfo.tier && !isUnavailable(champion.name)" x-text="champion.poolInfo?.tier" x-cloak></span>
                        <div class="player-badge-container" x-show="champion.poolInfo?.isInPool && champion.poolInfo.players?.length > 0 && !isUnavailable(champion.name)" x-cloak>
                          <template x-for="player in (champion.poolInfo?.players || [])" :key="player">
                            <img class="player-badge" :src="getRoleIconUrl(player)" :alt="player" :title="player" draggable="false" />
                          </template>
                        </div>
                      </div>
                    </template>
                  </div>
                </div>
              </div>

              <div class="unavailable-champions-panel">
                <div class="unavailable-holding-area" x-show="unplacedChampions.length > 0" x-cloak x-transition:enter="transition-all ease-out duration-300" x-transition:enter-start="opacity-0 max-h-0 !p-0 !mb-0" x-transition:enter-end="opacity-100 max-h-[25vh] p-[6px] mb-2 overflow-y-auto" x-transition:leave="transition-all ease-in duration-200" x-transition:leave-start="opacity-100 max-h-[25vh] p-[6px] mb-2 overflow-y-auto" x-transition:leave-end="opacity-0 max-h-0 !p-0 !mb-0">
                  <template x-for="championName in unplacedChampions" :key="championName">
                    <img :src="getChampionIconUrl(championName, 'holding-area')" :alt="championName" :title="championName" class="holding-area-champ" :class="{'selected-for-placement': selectedForPlacement === championName}" @click="selectForPlacement(championName)" @contextmenu.prevent="revertUnavailableChampion(championName)" draggable="false" />
                  </template>
                </div>

                <div class="unavailable-roles-wrapper">
                  <template x-if="!settings.pool.groupByGames">
                    <div class="unavailable-by-roles">
                      <template x-for="role in rolesForPanel" :key="role">
                        <div class="unavailable-role-group">
                          <img :src="getRoleIconUrl(role)" class="unavailable-role-icon" :alt="role" />
                          <div class="unavailable-slots-grid">
                            <template x-for="i in 5" :key="`${role}-col-${i}`">
                              <div class="unavailable-slot-column">
                                <div class="unavailable-slot" :data-slot-id="`${role}-${i-1}`" @click="handlePanelSlotClick(role, i - 1)" @contextmenu.prevent="clearUnavailableSlot(role, i - 1)" :class="{'selected-for-move': selectedChampionFromPanel && selectedChampionFromPanel.role === role && selectedChampionFromPanel.index === (i - 1)}" title="Click to place/move selected champion, Right-click to clear">
                                  <template x-if="unavailablePanelState[role][i - 1]">
                                    <img :src="getChampionIconUrl(unavailablePanelState[role][i - 1])" :alt="unavailablePanelState[role][i - 1]" x-cloak draggable="false" />
                                  </template>
                                  <template x-if="!unavailablePanelState[role][i - 1]">
                                    <img src="./assets/icons/no_champion.png" alt="Empty slot" class="placeholder-icon" x-cloak draggable="false" />
                                  </template>
                                </div>
                                <div class="unavailable-slot" :data-slot-id="`${role}-${i-1+5}`" @click="handlePanelSlotClick(role, i - 1 + 5)" @contextmenu.prevent="clearUnavailableSlot(role, i - 1 + 5)" :class="{'selected-for-move': selectedChampionFromPanel && selectedChampionFromPanel.role === role && selectedChampionFromPanel.index === (i - 1 + 5)}" title="Click to place/move selected champion, Right-click to clear">
                                  <template x-if="unavailablePanelState[role][i - 1 + 5]">
                                    <img :src="getChampionIconUrl(unavailablePanelState[role][i - 1 + 5])" :alt="unavailablePanelState[role][i - 1 + 5]" x-cloak draggable="false" />
                                  </template>
                                  <template x-if="!unavailablePanelState[role][i - 1 + 5]">
                                    <img src="./assets/icons/no_champion.png" alt="Empty slot" class="placeholder-icon" x-cloak draggable="false" />
                                  </template>
                                </div>
                                <span class="slot-label" x-text="`G${i}`"></span>
                              </div>
                            </template>
                          </div>
                        </div>
                      </template>
                    </div>
                  </template>

                  <template x-if="settings.pool.groupByGames">
                    <div class="unavailable-by-games">
                      <template x-for="(game, gameIndex) in gamesForPanel" :key="game">
                        <div class="unavailable-game-group">
                          <span class="game-label" x-text="game"></span>
                          <div class="unavailable-slots-grid">
                            <template x-for="(role, roleIndex) in rolesForPanel" :key="`${game}-${role}`">
                              <div class="unavailable-slot-column">
                                <div class="unavailable-slot" :data-slot-id="`${role}-${gameIndex}`" @click="handlePanelSlotClick(role, gameIndex)" @contextmenu.prevent="clearUnavailableSlot(role, gameIndex)" :class="{'selected-for-move': selectedChampionFromPanel && selectedChampionFromPanel.role === role && selectedChampionFromPanel.index === gameIndex}">
                                  <template x-if="unavailablePanelState[role][gameIndex]">
                                    <img :src="getChampionIconUrl(unavailablePanelState[role][gameIndex])" :alt="unavailablePanelState[role][gameIndex]" x-cloak draggable="false" />
                                  </template>
                                  <template x-if="!unavailablePanelState[role][gameIndex]">
                                    <img src="./assets/icons/no_champion.png" alt="Empty slot" class="placeholder-icon" x-cloak draggable="false" />
                                  </template>
                                </div>
                                <div class="unavailable-slot" :data-slot-id="`${role}-${gameIndex + 5}`" @click="handlePanelSlotClick(role, gameIndex + 5)" @contextmenu.prevent="clearUnavailableSlot(role, gameIndex + 5)" :class="{'selected-for-move': selectedChampionFromPanel && selectedChampionFromPanel.role === role && selectedChampionFromPanel.index === (gameIndex + 5)}">
                                  <template x-if="unavailablePanelState[role][gameIndex + 5]">
                                    <img :src="getChampionIconUrl(unavailablePanelState[role][gameIndex + 5])" :alt="unavailablePanelState[role][gameIndex + 5]" x-cloak draggable="false" />
                                  </template>
                                  <template x-if="!unavailablePanelState[role][gameIndex + 5]">
                                    <img src="./assets/icons/no_champion.png" alt="Empty slot" class="placeholder-icon" x-cloak draggable="false" />
                                  </template>
                                </div>
                                <img :src="getRoleIconUrl(role)" class="role-icon-label" :alt="role" />
                              </div>
                            </template>
                          </div>
                        </div>
                      </template>
                    </div>
                  </template>
                </div>
              </div>
            </div>
            <div x-show="championPoolView === 'compact'" class="compact-view-container" x-cloak x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0">
              <template x-for="role in rolesForPanel" :key="role">
                <div class="role-pillar">
                  <div class="pillar-header-wrapper">
                    <img :src="getRoleIconUrl(role)" :alt="role" class="pillar-header-icon" />
                  </div>
                  <div class="pillar-champions-grid">
                    <template x-for="champion in championsByRoleForCompactView[role]" :key="champion.id + '-' + role">
                      <div
                        class="compact-champion-card"
                        :class="{
                          'unavailable': isUnavailable(champion.name),
                          'op-tier': isOpForRole(champion.name, role) && !isUnavailable(champion.name),
                          'manually-marked': isHighlighted(champion.name) && !isUnavailable(champion.name)
                        }"
                        @click="togglePick(champion.name)"
                        @contextmenu.prevent="toggleHighlight(champion.name)"
                        :title="champion.name"
                      >
                        <div class="compact-champion-icon-wrapper">
                          <img class="compact-champion-icon" :src="getChampionIconUrl(champion.name, 'creator-pool')" :alt="champion.name" draggable="false" />
                          <div class="champion-icon-corners"></div>
                        </div>
                        <span class="compact-champion-name" x-text="champion.name"></span>
                      </div>
                    </template>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </div>

        <div x-show="currentView === 'drafting'" class="draft-creator-view absolute w-full top-0 left-0" x-cloak>
          <div class="draft-creator-main-wrapper">
            <div class="draft-indicator-container">
              <div class="indicator-rect blue-indicator"></div>
              <div class="indicator-rect red-indicator"></div>
            </div>

            <div class="draft-creator-bans-header">
              <div class="draft-creator-bans blue-bans">
                <template x-for="i in 3" :key="`creator-b-ban-${i}`">
                  <div
                    class="draft-creator-slot ban-slot"
                    :class="{
                                        'filled': currentDraft.blueBans[i-1].champion,
                                        'has-notes': currentDraft.blueBans[i-1].notes,
                                        'selected-for-move': selectedChampionSource && selectedChampionSource.side === 'blue' && selectedChampionSource.type === 'bans' && selectedChampionSource.index === (i-1),
                                        'selected-for-targeting': selectedTargetSlot && selectedTargetSlot.side === 'blue' && selectedTargetSlot.type === 'bans' && selectedTargetSlot.index === (i-1) && !currentDraft.blueBans[i-1].champion
                                     }"
                    @click="handleSlotClick('blue', 'bans', i-1)"
                    @contextmenu.prevent="clearCreatorSlot('blue', 'bans', i-1)"
                    title="Click to place/move/target, Right-click to clear"
                  >
                    <template x-if="currentDraft.blueBans[i-1].champion">
                      <img :src="getChampionIconUrl(currentDraft.blueBans[i-1].champion, 'ban')" :alt="currentDraft.blueBans[i-1].champion" draggable="false" onerror="this.style.opacity=0.5" />
                    </template>
                    <button class="notes-toggle-button" @click.stop="toggleNotesVisibility('blue', 'bans', i-1)" title="Edit Notes">
                      <svg><use href="#icon-note"></use></svg>
                    </button>
                  </div>
                </template>
                <div class="ban-group-separator horizontal"></div>
                <template x-for="i in 2" :key="`creator-b-ban-${i+3}`">
                  <div
                    class="draft-creator-slot ban-slot"
                    :class="{
                                        'filled': currentDraft.blueBans[i+2].champion,
                                        'has-notes': currentDraft.blueBans[i+2].notes,
                                        'selected-for-move': selectedChampionSource && selectedChampionSource.side === 'blue' && selectedChampionSource.type === 'bans' && selectedChampionSource.index === (i+2),
                                        'selected-for-targeting': selectedTargetSlot && selectedTargetSlot.side === 'blue' && selectedTargetSlot.type === 'bans' && selectedTargetSlot.index === (i+2) && !currentDraft.blueBans[i+2].champion
                                      }"
                    @click="handleSlotClick('blue', 'bans', i+2)"
                    @contextmenu.prevent="clearCreatorSlot('blue', 'bans', i+2)"
                    title="Click to place/move/target, Right-click to clear"
                  >
                    <template x-if="currentDraft.blueBans[i+2].champion">
                      <img :src="getChampionIconUrl(currentDraft.blueBans[i+2].champion, 'ban')" :alt="currentDraft.blueBans[i+2].champion" draggable="false" onerror="this.style.opacity=0.5" />
                    </template>
                    <button class="notes-toggle-button" @click.stop="toggleNotesVisibility('blue', 'bans', i+2)" title="Edit Notes">
                      <svg><use href="#icon-note"></use></svg>
                    </button>
                  </div>
                </template>
              </div>
              <div class="draft-creator-bans red-bans">
                <template x-for="i in 2" :key="`creator-r-ban-rev-${5-i}`">
                  <div
                    class="draft-creator-slot ban-slot"
                    :class="{
                                       'filled': currentDraft.redBans[5-i].champion,
                                       'has-notes': currentDraft.redBans[5-i].notes,
                                       'selected-for-move': selectedChampionSource && selectedChampionSource.side === 'red' && selectedChampionSource.type === 'bans' && selectedChampionSource.index === (5-i),
                                       'selected-for-targeting': selectedTargetSlot && selectedTargetSlot.side === 'red' && selectedTargetSlot.type === 'bans' && selectedTargetSlot.index === (5-i) && !currentDraft.redBans[5-i].champion
                                    }"
                    @click="handleSlotClick('red', 'bans', 5-i)"
                    @contextmenu.prevent="clearCreatorSlot('red', 'bans', 5-i)"
                    title="Click to place/move/target, Right-click to clear"
                  >
                    <template x-if="currentDraft.redBans[5-i].champion">
                      <img :src="getChampionIconUrl(currentDraft.redBans[5-i].champion, 'ban')" :alt="currentDraft.redBans[5-i].champion" draggable="false" onerror="this.style.opacity=0.5" />
                    </template>
                    <button class="notes-toggle-button" @click.stop="toggleNotesVisibility('red', 'bans', 5-i)" title="Edit Notes">
                      <svg><use href="#icon-note"></use></svg>
                    </button>
                  </div>
                </template>
                <div class="ban-group-separator horizontal"></div>
                <template x-for="i in 3" :key="`creator-r-ban-rev-${3-i}`">
                  <div
                    class="draft-creator-slot ban-slot"
                    :class="{
                                       'filled': currentDraft.redBans[3-i].champion,
                                       'has-notes': currentDraft.redBans[3-i].notes,
                                       'selected-for-move': selectedChampionSource && selectedChampionSource.side === 'red' && selectedChampionSource.type === 'bans' && selectedChampionSource.index === (3-i),
                                       'selected-for-targeting': selectedTargetSlot && selectedTargetSlot.side === 'red' && selectedTargetSlot.type === 'bans' && selectedTargetSlot.index === (3-i) && !currentDraft.redBans[3-i].champion
                                    }"
                    @click="handleSlotClick('red', 'bans', 3-i)"
                    @contextmenu.prevent="clearCreatorSlot('red', 'bans', 3-i)"
                    title="Click to place/move/target, Right-click to clear"
                  >
                    <template x-if="currentDraft.redBans[3-i].champion">
                      <img :src="getChampionIconUrl(currentDraft.redBans[3-i].champion, 'ban')" :alt="currentDraft.redBans[3-i].champion" draggable="false" onerror="this.style.opacity=0.5" />
                    </template>
                    <button class="notes-toggle-button" @click.stop="toggleNotesVisibility('red', 'bans', 3-i)" title="Edit Notes">
                      <svg><use href="#icon-note"></use></svg>
                    </button>
                  </div>
                </template>
              </div>
            </div>
            <div class="draft-creator-main-content">
              <div class="draft-creator-layout">
                <div class="draft-creator-side blue-side">
                  <h3 class="side-title">Blue Side</h3>
                  <div class="draft-creator-picks">
                    <template x-for="i in 5" :key="`creator-b-pick-${i}`">
                      <div class="pick-row blue">
                        <span class="pick-label" x-text="`B${i}`"></span>
                        <div
                          class="draft-creator-slot pick-slot"
                          :data-pick-order="`B${i}`"
                          :class="{
                                                    'filled': currentDraft.bluePicks[i-1].champion,
                                                    'has-notes': currentDraft.bluePicks[i-1].notes,
                                                    'selected-for-move': selectedChampionSource && selectedChampionSource.side === 'blue' && selectedChampionSource.type === 'picks' && selectedChampionSource.index === (i-1),
                                                    'selected-for-targeting': selectedTargetSlot && selectedTargetSlot.side === 'blue' && selectedTargetSlot.type === 'picks' && selectedTargetSlot.index === (i-1) && !currentDraft.bluePicks[i-1].champion
                                                 }"
                          @click="handleSlotClick('blue', 'picks', i-1)"
                          @contextmenu.prevent="clearCreatorSlot('blue', 'picks', i-1)"
                          title="Click to place/move/target, Right-click to clear"
                        >
                          <template x-if="currentDraft.bluePicks[i-1].champion">
                            <img :src="getChampionIconUrl(currentDraft.bluePicks[i-1].champion, 'pick')" :alt="currentDraft.bluePicks[i-1].champion" draggable="false" onerror="this.style.opacity=0.5" />
                          </template>
                          <button class="notes-toggle-button" @click.stop="toggleNotesVisibility('blue', 'picks', i-1)" title="Edit Notes">
                            <svg><use href="#icon-note"></use></svg>
                          </button>
                        </div>
                      </div>
                    </template>
                  </div>
                </div>

                <div class="draft-creator-center">
                  <div class="draft-creator-pool-controls">
                    <div class="draft-creator-search-container">
                      <svg class="search-icon"><use href="#icon-search"></use></svg>
                      <input type="text" x-model.debounce.300ms="draftCreatorSearchTerm" placeholder="Search..." class="draft-creator-search-input" />
                      <button x-show="draftCreatorSearchTerm" @click="draftCreatorSearchTerm = ''" class="clear-search-button" aria-label="Clear search">&times;</button>
                    </div>
                    <div class="role-filters-container pool-filters">
                      <button @click="setDraftCreatorRoleFilter('Top')" class="filter-button icon-button" :class="{'active': draftCreatorRoleFilter === 'Top'}" title="Filter by Top Lane">
                        <img :src="getRoleIconUrl('Top')" alt="Top Lane" class="filter-icon" draggable="false" />
                      </button>
                      <button @click="setDraftCreatorRoleFilter('Jungle')" class="filter-button icon-button" :class="{'active': draftCreatorRoleFilter === 'Jungle'}" title="Filter by Jungle">
                        <img :src="getRoleIconUrl('Jungle')" alt="Jungle" class="filter-icon" draggable="false" />
                      </button>
                      <button @click="setDraftCreatorRoleFilter('Mid')" class="filter-button icon-button" :class="{'active': draftCreatorRoleFilter === 'Mid'}" title="Filter by Mid Lane">
                        <img :src="getRoleIconUrl('Mid')" alt="Mid Lane" class="filter-icon" draggable="false" />
                      </button>
                      <button @click="setDraftCreatorRoleFilter('Bot')" class="filter-button icon-button" :class="{'active': draftCreatorRoleFilter === 'Bot'}" title="Filter by Bot Lane">
                        <img :src="getRoleIconUrl('Bot')" alt="Bot Lane" class="filter-icon" draggable="false" />
                      </button>
                      <button @click="setDraftCreatorRoleFilter('Support')" class="filter-button icon-button" :class="{'active': draftCreatorRoleFilter === 'Support'}" title="Filter by Support">
                        <img :src="getRoleIconUrl('Support')" alt="Support" class="filter-icon" draggable="false" />
                      </button>
                    </div>
                  </div>
                  <div class="draft-creator-champion-grid">
                    <template x-for="champion in draftCreatorFilteredChampions" :key="champion.id">
                      <div
                        class="draft-creator-champion-card"
                        :class="{
                                                'selected-for-placement': selectedChampionForPlacement === champion.name,
                                                'already-placed': isChampionPlacedInCurrentDraft(champion.name) && !(selectedChampionSource && selectedChampionSource.championName === champion.name) /* Simplified check */
                                             }"
                        @click="selectChampionForPlacement(champion.name)"
                        :title="champion.name"
                      >
                        <img class="champion-icon" :src="getChampionIconUrl(champion.name, 'creator-pool')" :alt="champion.name" loading="lazy" draggable="false" />
                        <span class="champion-name-text" x-text="champion.name"></span>
                      </div>
                    </template>
                    <p x-show="draftCreatorFilteredChampions.length === 0" class="text-gray-400 col-span-full text-center py-4" x-cloak>No champions match filter/search.</p>
                  </div>
                  <div class="draft-creator-controls">
                    <button @click="saveCurrentDraft()" class="control-button save-button" title="Save Current Draft">
                      <svg><use href="#icon-check"></use></svg> Save Draft
                    </button>
                    <button @click="resetCurrentDraft()" class="control-button reset-button" title="Reset Current Draft">
                      <svg><use href="#icon-trash"></use></svg> Reset
                    </button>
                  </div>
                </div>

                <div class="draft-creator-side red-side">
                  <h3 class="side-title">Red Side</h3>
                  <div class="draft-creator-picks">
                    <template x-for="i in 5" :key="`creator-r-pick-${i}`">
                      <div class="pick-row red">
                        <div
                          class="draft-creator-slot pick-slot"
                          :data-pick-order="`R${i}`"
                          :class="{
                                                    'filled': currentDraft.redPicks[i-1].champion,
                                                    'has-notes': currentDraft.redPicks[i-1].notes,
                                                    'selected-for-move': selectedChampionSource && selectedChampionSource.side === 'red' && selectedChampionSource.type === 'picks' && selectedChampionSource.index === (i-1),
                                                    'selected-for-targeting': selectedTargetSlot && selectedTargetSlot.side === 'red' && selectedTargetSlot.type === 'picks' && selectedTargetSlot.index === (i-1) && !currentDraft.redPicks[i-1].champion
                                                 }"
                          @click="handleSlotClick('red', 'picks', i-1)"
                          @contextmenu.prevent="clearCreatorSlot('red', 'picks', i-1)"
                          title="Click to place/move/target, Right-click to clear"
                        >
                          <template x-if="currentDraft.redPicks[i-1].champion">
                            <img :src="getChampionIconUrl(currentDraft.redPicks[i-1].champion, 'pick')" :alt="currentDraft.redPicks[i-1].champion" draggable="false" onerror="this.style.opacity=0.5" />
                          </template>
                          <button class="notes-toggle-button" @click.stop="toggleNotesVisibility('red', 'picks', i-1)" title="Edit Notes">
                            <svg><use href="#icon-note"></use></svg>
                          </button>
                        </div>
                        <span class="pick-label" x-text="`R${i}`"></span>
                      </div>
                    </template>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="draft-creator-saved">
            <h3 class="saved-title">Saved Drafts (<span x-text="savedDrafts.length"></span>)</h3>
            <div class="saved-drafts-list">
              <p x-show="isLoadingSavedDrafts" class="text-gray-400 text-center p-4">Loading saved drafts...</p>
              <p x-show="!isLoadingSavedDrafts && savedDrafts.length === 0" class="text-gray-400 text-center p-4">No drafts saved yet.</p>
              <template x-for="draft in savedDrafts" :key="draft.id">
                <div class="saved-draft-item" :class="{'active-saved-draft': currentDraft.id === draft.id}">
                  <span class="saved-draft-name" x-text="draft.name || 'Unnamed Draft'" @click="loadSavedDraft(draft.id)"></span>
                  <div class="saved-draft-actions">
                    <button @click="openConfirmationModal({ message: `Are you sure you want to permanently delete '${draft.name || 'this draft'}'? This cannot be undone.`, confirmAction: () => deleteSavedDraft(draft.id), isDanger: true })" title="Delete Draft">
                      <svg><use href="#icon-trash"></use></svg>
                    </button>
                  </div>
                </div>
              </template>
            </div>
          </div>

          <div x-show="notesModal.isOpen" class="notes-modal-overlay" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100" x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100" x-transition:leave-end="opacity-0" @keydown.escape.window="closeNotesModal()" x-cloak>
            <div class="notes-modal-content" @click.outside="closeNotesModal()">
              <h3 class="modal-title" x-text="notesModal.title">Edit Notes</h3>
              <textarea class="notes-modal-textarea" x-model="notesModal.currentNote" placeholder="Enter notes here..." x-ref="notesTextarea"></textarea>
              <div class="modal-buttons">
                <button @click="saveNotesAndCloseModal()" class="modal-button modal-button-confirm">Save & Close</button>
                <button @click="closeNotesModal()" class="modal-button modal-button-cancel">Cancel</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div x-show="confirmationModal.isOpen" x-dialog @keydown.escape.window="closeConfirmationModal()" class="relative z-50" x-cloak>
      <div x-show="confirmationModal.isOpen" x-transition.opacity class="fixed inset-0 bg-black/60"></div>
      <div class="fixed inset-0 flex w-screen items-center justify-center p-4">
        <div x-show="confirmationModal.isOpen" x-transition @click.outside="closeConfirmationModal()" x-dialog.panel class="w-full max-w-md rounded-lg bg-gray-800 border border-gray-700 p-6 shadow-lg">
          <h3 x-dialog.title class="text-xl font-semibold text-white">Confirm Action</h3>
          <p class="mt-2 text-gray-300" x-text="confirmationModal.message"></p>
          <div class="mt-6 flex justify-end gap-3">
            <button @click="closeConfirmationModal()" class="modal-button modal-button-cancel">Cancel</button>
            <button @click="confirmAction()" :class="confirmationModal.isDanger ? 'modal-button-danger' : 'modal-button-confirm'" class="modal-button">Confirm</button>
          </div>
        </div>
      </div>
    </div>

    <div x-show="isSettingsOpen" x-dialog @keydown.escape.window="isSettingsOpen = false" class="relative z-50" x-cloak>
      <div x-show="isSettingsOpen" x-transition.opacity class="fixed inset-0 bg-black/60"></div>
      <div class="fixed inset-0 flex w-screen items-center justify-center p-4">
        <div x-show="isSettingsOpen" x-transition @click.outside="isSettingsOpen = false" x-dialog.panel class="w-full max-w-lg rounded-lg bg-gray-800 border border-gray-700 p-6 shadow-lg">
          <h3 x-dialog.title class="text-xl font-semibold text-white">Settings</h3>

          <div class="settings-tabs">
            <button @click="settingsTab = 'pool'" class="settings-tab-button" :class="{'active': settingsTab === 'pool'}">Champion Pool</button>
            <button @click="settingsTab = 'drafting'" class="settings-tab-button" :class="{'active': settingsTab === 'drafting'}">General</button>
          </div>

          <div x-show="settingsTab === 'pool'" class="mt-4 space-y-2 text-gray-300">
            <div class="flex items-center justify-between py-3 border-b border-gray-700">
              <label for="toggle-player-tier" class="font-medium">Show Player Tier (Borders & Badges)</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none">
                <input type="checkbox" x-model="settings.pool.showPlayerTier" name="toggle-player-tier" id="toggle-player-tier" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="toggle-player-tier" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-600 cursor-pointer"></label>
              </div>
            </div>
            <div class="flex items-center justify-between py-3 border-b border-gray-700">
              <label for="toggle-role-badges" class="font-medium">Show Role Badges</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none">
                <input type="checkbox" x-model="settings.pool.showRoleBadges" name="toggle-role-badges" id="toggle-role-badges" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="toggle-role-badges" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-600 cursor-pointer"></label>
              </div>
            </div>
            <div class="flex items-center justify-between py-3 border-b border-gray-700">
              <label for="toggle-group-by-games" class="font-medium">Group Unavailable by Games</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none">
                <input type="checkbox" x-model="settings.pool.groupByGames" name="toggle-group-by-games" id="toggle-group-by-games" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" />
                <label for="toggle-group-by-games" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-600 cursor-pointer"></label>
              </div>
            </div>
          </div>

          <div x-show="settingsTab === 'drafting'" class="mt-4 space-y-2 text-gray-300">
            <div class="flex items-center justify-between py-3 border-b border-gray-700">
              <label for="toggle-dark-mode" class="font-medium">Dark Mode</label>
              <div class="relative inline-block w-10 mr-2 align-middle select-none">
                <input type="checkbox" name="toggle-dark-mode" id="toggle-dark-mode" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer" checked disabled />
                <label for="toggle-dark-mode" class="toggle-label block overflow-hidden h-6 rounded-full bg-gray-600 cursor-not-allowed opacity-50"></label>
              </div>
            </div>
            <div class="flex items-center justify-between py-3 border-b border-gray-700">
              <label for="language-select" class="font-medium">Language</label>
              <select id="language-select" class="bg-gray-700 border border-gray-600 rounded-md p-1 text-white focus:outline-none focus:ring-2 focus:ring-amber-500">
                <option>English</option>
                <option disabled>Español (coming soon)</option>
                <option disabled>Français (coming soon)</option>
              </select>
            </div>
          </div>

          <div class="mt-6 flex justify-end gap-3">
            <button @click="isSettingsOpen = false" class="modal-button modal-button-confirm">Close</button>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
